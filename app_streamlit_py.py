# -*- coding: utf-8 -*-
"""app_streamlit.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1u7roUCX6NOytS9ctMkiwEzhyvLAAeHzJ
"""

from google.colab import files
uploaded = files.upload()

from google.colab import files
uploaded = files.upload()

from google.colab import files
uploaded = files.upload()

from google.colab import files
uploaded = files.upload()

from google.colab import files
uploaded = files.upload()

!pwd
!ls -la

# Commented out IPython magic to ensure Python compatibility.
# %%writefile predict_utils.py
# import numpy as np
# import pickle
# from tensorflow.keras.models import load_model
# 
# # Load scaler
# with open("scaler.pkl", "rb") as f:
#     scaler = pickle.load(f)
# 
# # Load models
# models = {
#     "LSTM": load_model("lstm_model.h5"),
#     "RNN": load_model("rnn_model.h5"),
#     "GRU": load_model("gru_model.h5")
# }
# 
# # Prediction function
# def predict_next(model_name, last_60):
#     model = models[model_name]
#     scaled_input = scaler.transform(last_60.reshape(-1, 1))
#     X = scaled_input.reshape(1, 60, 1)
#     pred_scaled = model.predict(X)
#     pred = scaler.inverse_transform(pred_scaled)[0][0]
#     return float(pred)
#

!mkdir -p templates

!pip install streamlit plotly

# Commented out IPython magic to ensure Python compatibility.
# %%writefile app_streamlit.py
# import streamlit as st
# import pandas as pd
# import numpy as np
# import plotly.graph_objects as go
# from predict_utils import predict_next
# 
# st.set_page_config(
#     page_title="Google Stock Predictor",
#     layout="wide",
#     page_icon="ðŸ“ˆ"
# )
# 
# # Load Dataset
# df = pd.read_csv("google_stock_cleaned.csv")
# df["Date"] = pd.to_datetime(df["Date"])
# close_data = df["Close"].values
# 
# # Title
# st.markdown(
#     """
#     <h1 style='text-align:center; color:#00c6ff;'>
#         ðŸ“ˆ Google Stock Forecasting Dashboard
#     </h1>
#     """,
#     unsafe_allow_html=True
# )
# 
# # Sidebar
# st.sidebar.header("âš™ Settings")
# model_name = st.sidebar.selectbox("Choose Model", ["LSTM", "RNN", "GRU"])
# predict_btn = st.sidebar.button("Predict Next Day Price ðŸ”®")
# 
# # Latest market stats
# latest = df.iloc[-1]
# 
# c1, c2, c3, c4 = st.columns(4)
# c1.metric("Open", f"${latest['Open']:.2f}")
# c2.metric("High", f"${latest['High']:.2f}")
# c3.metric("Low", f"${latest['Low']:.2f}")
# c4.metric("Close", f"${latest['Close']:.2f}")
# 
# # Moving averages
# df["MA50"] = df["Close"].rolling(50).mean()
# df["MA200"] = df["Close"].rolling(200).mean()
# 
# # Candlestick + MA chart
# fig = go.Figure()
# fig.add_trace(go.Candlestick(
#     x=df["Date"],
#     open=df["Open"],
#     high=df["High"],
#     low=df["Low"],
#     close=df["Close"],
#     name="Candlestick"
# ))
# 
# fig.add_trace(go.Scatter(
#     x=df["Date"], y=df["MA50"],
#     name="MA50", line=dict(width=2)
# ))
# 
# fig.add_trace(go.Scatter(
#     x=df["Date"], y=df["MA200"],
#     name="MA200", line=dict(width=2)
# ))
# 
# fig.update_layout(
#     title="ðŸ“Š Market Structure (Candlestick + MA50 + MA200)",
#     template="plotly_dark",
#     height=500
# )
# 
# st.plotly_chart(fig, use_container_width=True)
# 
# # Prediction Section
# if predict_btn:
#     last_60 = close_data[-60:]
#     pred = predict_next(model_name, last_60)
# 
#     st.success(f"### ðŸŽ¯ Predicted Next Close Price using {model_name}: **${pred:.2f}**")
# 
#     # Prediction chart
#     fig2 = go.Figure()
#     fig2.add_trace(go.Scatter(
#         x=df["Date"].iloc[-60:], y=last_60,
#         mode="lines+markers", name="Last Prices"
#     ))
# 
#     fig2.add_trace(go.Scatter(
#         x=[df["Date"].iloc[-1], df["Date"].iloc[-1] + pd.Timedelta(days=1)],
#         y=[last_60[-1], pred],
#         mode="lines+markers", name="Prediction",
#         line=dict(dash="dash", width=3)
#     ))
# 
#     fig2.update_layout(
#         title="ðŸ”® Prediction Graph",
#         template="plotly_dark",
#         height=400
#     )
# 
#     st.plotly_chart(fig2, use_container_width=True)
#

!pip install pyngrok

from pyngrok import ngrok
ngrok.set_auth_token("36kmJ0bvtMRe9zUugdkn8crDcZs_7exgRJYj67DRvYUxXkTPn")

!pip install streamlit
!streamlit run app_streamlit.py